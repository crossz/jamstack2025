## 教学内容 by Minimax+pdf

### 第一章
**1. 教学目的和要求**
(1)能够定义云原生应用的特征，理解从单体架构到微服务的转变。
(2)掌握容器和Kubernetes基本概念（Pod、服务、标签、命名空间）的概念与作用。
(3)通过实践初步体验容器化部署和Kubernetes环境搭建。

**2. 教学内容**
(1)云原生概念：云计算的演进、云原生之路。
(2)微服务架构：从单体到微服务的转变，微服务在云原生中的地位。
(3)容器化基础：容器的概念与作用，Docker简介。
(4)Kubernetes基础概念：Pod的定义与特性、服务的功能与类型、标签和注解、命名空间。
**3. 重点**
- 理解云原生与容器化的基本概念，初步掌握Kubernetes的核心概念。

**4. 难点**
- 从传统架构到云原生架构的思维转变，理解Pod作为最小部署单元的意义。

**5. 学时: 5**

### 第二章
**1. 教学目的和要求**
(1)能够理解容器和Kubernetes资源管理的原理，掌握资源请求与限制的配置方法。
(2)能够通过实践在Docker和Kubernetes中配置资源限制，观察调度行为。
(3)理解容量规划对集群资源优化的重要性。

**2. 教学内容**
(1)容器资源管理：应用运行时的资源需求差异，Docker资源限制初步介绍。
(2)Kubernetes资源管理：资源请求与限制、Pod优先级、ResourceQuota和LimitRange。
(3)容量规划：集群资源规划的基本方法。

**3. 重点**
- 掌握容器与Kubernetes的资源管理机制，确保应用高效运行。

**4. 难点**
- 准确评估应用的资源需求并配置合理的限制。

**5. 学时：4**


### 第三章 声明式部署  
**1. 教学目的和要求**  
(1) 理解Kubernetes Deployment的核心机制，掌握不同部署策略（滚动更新、Recreate、Blue-Green、Canary）的适用场景。  
(2) 能够通过`kubectl rollout`命令和YAML配置实现应用升级与回滚。  
(3) 掌握高级部署工具（如Flagger、Argo Rollouts）的扩展能力。  

**2. 教学内容**  
(1) **Deployment基础**：  
   - Deployment与ReplicaSet的关系，Pod模板的作用。  
   - 部署策略类型：`RollingUpdate`（默认）与`Recreate`的对比。  
(2) **滚动更新实践**：  
   - 配置`maxSurge`和`maxUnavailable`控制更新速率。  
   - 使用`kubectl rollout`监控状态、执行暂停/恢复/回滚操作。  
(3) **高级部署策略**：  
   - Blue-Green：基于Service切换流量。  
   - Canary：基于副本数比例逐步替换。  
(4) **扩展工具**：  
   - Flagger/Argo Rollouts实现自动化金丝雀发布。  

**3. 重点**  
- 掌握滚动更新的参数配置和风险控制。  
- 理解不同部署策略对服务连续性的影响。  

**4. 难点**  
- 在复杂场景下选择合适的部署策略（如兼容性要求高的API升级）。  

**5. 学时：4**  
   - 理论讲解：2小时（Deployment原理、策略对比）。  
   - 实践操作：2小时（配置滚动更新、演示Blue-Green/Canary）。  

---

### 第四章 健康探针  
**1. 教学目的和要求**  
(1) 掌握Liveness、Readiness、Startup探针的作用及配置方法。  
(2) 能够根据应用特性选择合适的探针类型（HTTP/TCP/Exec/gRPC）。  
(3) 理解探针参数（`initialDelaySeconds`、`periodSeconds`等）对稳定性的影响。  

**2. 教学内容**  
(1) **探针类型详解**：  
   - **Liveness Probe**：检测应用是否存活（自动重启）。  
   - **Readiness Probe**：控制流量接入（避免未就绪 Pod 被访问）。  
   - **Startup Probe**：长启动时间的应用（如Java应用服务器）。  
(2) **配置参数与示例**：  
   - HTTP探针：检查`/health`端点。  
   - Exec探针：检查文件存在性。  
   - TCP探针：端口连通性。  
(3) **高级场景**：  
   - 自定义就绪门（Readiness Gates）配合外部负载均衡器。  

**3. 重点**  
- 区分Liveness与Readiness探针的职责：存活 vs. 就绪。  
- 合理设置探针参数避免误判（如启动延迟）。  

**4. 难点**  
- 复杂应用（如微服务）的探针设计，确保依赖项（如数据库）就绪后再接收流量。  

**5. 学时：4**  
   - 理论讲解：1.5小时（探针类型与参数）。  
   - 案例分析：1小时（不同应用的探针配置示例）。  
   - 实践操作：1.5小时（部署带探针的应用，观察行为）。  

---

### 第五章 生命周期管理  
**1. 教学目的和要求**  
(1) 理解Kubernetes容器生命周期事件（SIGTERM、PostStart、PreStop）。  
(2) 掌握钩子（Hook）的配置方法及适用场景。  
(3) 了解Init容器与生命周期钩子的协同使用。  

**2. 教学内容**  
(1) **核心事件**：  
   - **SIGTERM**：优雅关闭的触发信号。  
   - **SIGKILL**：强制终止（默认30秒超时）。  
(2) **钩子配置**：  
   - **PostStart**：初始化依赖项（如等待配置加载）。  
   - **PreStop**：清理资源（如通知注册中心下线）。  
(3) **高级控制**：  
   - Init容器：Pod级初始化任务（如预加载数据）。  
   - Entrypoint重写：自定义启动顺序与依赖。  

**3. 重点**  
- 钩子的正确使用场景（避免过度依赖导致维护复杂）。  
- Init容器与普通容器的执行顺序差异。  

**4. 难点**  
- 调试钩子执行失败（如超时、权限问题）。  

**5. 学时：4**  
   - 理论讲解：1.5小时（事件流程与钩子类型）。  
   - 案例演示：1.5小时（配置PostStart/PreStop钩子）。  
   - 讨论：1小时（何时使用钩子 vs. Init容器）。  

---

### 第六章 自动放置  
**1. 教学目的和要求**  
(1) 理解Kubernetes调度器工作原理（过滤、评分、绑定）。  
(2) 掌握节点亲和性、Pod亲和性、污点/容忍的配置方法。  
(3) 能够通过调度策略优化集群资源利用率与高可用性。  

**2. 教学内容**  
(1) **调度基础**：  
   - 资源声明（`requests/limits`）对调度的决定性作用。  
   - 节点容量计算（`Allocatable = Node Capacity - Reserved`）。  
(2) **调度策略**：  
   - **节点亲和性**：硬性/软性规则（`required/preferred`）。  
   - **Pod亲和性/反亲和性**：基于标签的Pod分布控制。  
   - **污点（taint）与容忍（toleration）**：节点专属化（如控制平面节点）。  
(3) **高级特性**：  
   - **拓扑分布约束（Topology Spread Constraints）**：跨故障域均衡部署。  
   - **自定义调度器**：扩展调度逻辑（如成本优化）。  

**3. 重点**  
- 节点亲和性与Pod亲和性的适用场景（如跨可用区部署）。  
- 污点/容忍实现节点隔离（如专用GPU节点）。  

**4. 难点**  
- 复杂调度需求的多策略组合（如同时满足资源、标签、拓扑约束）。  

**5. 学时：4**  
   - 理论讲解：2小时（调度流程与策略类型）。  
   - 实践操作：2小时（配置亲和性/反亲和性，验证调度结果）。  


---

## 第七章 行为模式（Behavioral Patterns）  
**1. 教学目的和要求**  
(1) 掌握不同Pod管理模式（Job、CronJob、DaemonSet、Singleton等）的适用场景。  
(2) 能够根据业务需求选择并配置对应模式（如批处理、定时任务、守护进程）。  
(3) 理解PodDisruptionBudget对高可用性的保障机制。  

**2. 教学内容**  
(1) **批处理任务（Batch Job）**：  
   - Job资源定义与参数（`completions`、`parallelism`）。  
   - 索引任务（Indexed Job）与工作队列模式。  
(2) **定时任务（Periodic Job）**：  
   - CronJob配置（`schedule`、`concurrencyPolicy`）。  
   - 分布式任务调度挑战与解决方案。  
(3) **守护进程（Daemon Service）**：  
   - DaemonSet特性（节点级部署、静态Pod对比）。  
   - 典型用例（监控、日志收集）。  
(4) **单例服务（Singleton Service）**：  
   - 分布式锁实现（外部锁如ZooKeeper vs. 内部锁如Lease）。  
   - PodDisruptionBudget防止意外中断。  

**3. 重点**  
- 区分Job与CronJob的使用场景（如一次性任务 vs. 周期性任务）。  
- 理解DaemonSet与普通Pod的调度差异。  

**4. 难点**  
- 复杂任务的分片与并行处理设计（如视频转码的索引任务）。  

**5. 学时：8**  
   - 理论：4小时（各模式原理与对比）。  
   - 实践：4小时（部署Job/CronJob/DaemonSet，模拟单例竞争）。  

---

## 第八章 结构模式（Structural Patterns）  
**1. 教学目的和要求**  
(1) 掌握Init Container、Sidecar等结构模式的应用场景。  
(2) 能够通过容器组合解决依赖初始化、数据预加载等问题。  

**2. 教学内容**  
(1) **Init Container**：  
   - Pod级初始化任务（依赖检查、数据准备）。  
   - 与普通容器的执行顺序差异。  
(2) **Sidecar模式**：  
   - 辅助容器设计（如日志收集代理、配置同步）。  
   - 典型用例（服务网格边车）。  

**3. 重点**  
- Init Container的串行执行特性及其使用限制。  
- Sidecar与主容器的通信机制（共享Volume、localhost）。  

**4. 难点**  
- 多容器Pod的资源分配与生命周期协同。  

**5. 学时：4**  
   - 理论：2小时（模式定义与示例）。  
   - 实践：2小时（部署带Init/Sidecar的Pod，观察行为）。  

---

## 第九章 配置模式（Configuration Patterns）  
**1. 教学目的和要求**  
(1) 掌握ConfigMap、Secret、Downward API的使用方法。  
(2) 能够实现应用配置的动态管理。  

**2. 教学内容**  
(1) **ConfigMap/Secret**：  
   - 注入方式（环境变量、Volume挂载）。  
   - 热更新机制与注意事项。  
(2) **Downward API**：  
   - 传递Pod元数据（名称、IP、资源限制）。  
   - 动态感知的应用设计（如日志标签）。  

**3. 重点**  
- 敏感信息管理（Secret加密与最小权限）。  
- 区分ConfigMap与Downward API的适用场景。  

**4. 难点**  
- 复杂配置的分层管理（如多环境覆盖）。  

**5. 学时：4**  
   - 理论：1.5小时（配置资源类型）。  
   - 实践：2.5小时（配置注入实验、热更新验证）。  

---

## 第十章 安全模式（Security Patterns）  
**1. 教学目的和要求**  
(1) 掌握Pod安全策略、NetworkPolicy的配置方法。  
(2) 能够实现集群与应用的纵深防御。  

**2. 教学内容**  
(1) **Pod安全**：  
   - SecurityContext（用户权限、Capabilities）。  
   - Pod Security Admission（PSA）策略。  
(2) **网络隔离**：  
   - NetworkPolicy规则（基于标签的流量控制）。  
   - 零信任架构实践。  

**3. 重点**  
- 最小权限原则在Kubernetes中的落地。  
- 跨命名空间通信的隔离设计。  

**4. 难点**  
- 复杂网络策略的调试与验证。  

**5. 学时：4**  
   - 理论：2小时（安全机制与策略类型）。  
   - 实践：2小时（配置PSA/NetworkPolicy，模拟攻防）。  

---

## 第十一章 高级模式（Advanced Patterns）  
**1. 教学目的和要求**  
(1) 掌握Operators、弹性伸缩、镜像构建等高级模式。  
(2) 能够设计云原生应用的扩展架构。  

**2. 教学内容**  
(1) **Operator模式**：  
   - CRD与控制器实现自定义资源管理。  
   - 典型案例（如Prometheus Operator）。  
(2) **弹性伸缩**：  
   - HPA（Horizontal Pod Autoscaler）与KEDA（事件驱动）。  
   - 集群自动扩缩容（Cluster Autoscaler）。  
(3) **镜像构建**：  
   - Kaniko、Buildah等工具链。  
   - 镜像漏洞扫描与合规。  

**3. 重点**  
- Operator模式对复杂应用管理的价值。  
- 弹性伸缩策略的设计与指标选择。  

**4. 难点**  
- 自定义Operator的开发流程与调试。  

**5. 学时：8**  
   - 理论：4小时（模式原理与架构）。  
   - 实践：4小时（部署Operator，实现HPA）。  

---

**教学建议**  
- 全书采用“理论+实验+案例分析”三段式教学，每章配套实验手册。  
- 复杂章节（如第七章、第十一章）建议拆分为多个实验单元，逐步深入。  
- 使用Kubernetes可视化工具（如Octant、Lens）辅助理解集群状态。